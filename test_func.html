<div style="text-align: center;">
	<div id="response"></div>
	<form onsubmit="return false"  name="client_form"  id="form" enctype="multipart/form-data">
		<input id="1" name="id_user" type="hidden" value=[get-login]>
		<input id="music_name_info_" name="music_name_info_" type="hidden">
		<input type="hidden" id="get_max_id_incr" disabled name="get_max_id_incr" value=[get_max_id_incr]>

		<h2 class="coloredHeader">Основная информация</h2>
		<p><strong>Номинация:</strong><br>
			<div style="color:#000">
				<select id="nomination_selectA" required name="nomination">
					<option disabled selected>Выберите номинацию</option>
					<option value="Street Show">Street Show</option>
					<option value="Show Girls">Show Girls</option>
					<option value="Современная хореография">Современная хореография</option>
					<option value="Эстрадный танец">Эстрадный танец</option>
					<option value="Народный танец">Народный танец</option>
					<option value="Классическая хореография">Классическая хореография</option>
				</select>
			</div>
		</p>
		<p><strong>Категория:</strong><br>
			<div style="color:#000">
				<select id="category" required name="category">
					<option selected disabled>Выберите категорию</option>
					<option value="Solo">Solo</option>
					<option value="Duo/Trio">Duo/Trio</option>
					<option value="Crew/Small Group(4-9 участников)">Crew/Small Group(4-9 участников)</option>
					<option value="Megacrew/Big Group(10-30 участников)">Megacrew/Big Group(10-30 участников)
					</option>
				</select>
			</div>
		</p>
		<p><strong>Уровень подготовки:</strong><br>
			<div style="color:#000">
				<select id="skill_level" required name="skill_level">
					<option selected disabled>Выберите уровень</option>
					<option value="Beginners (Начинающие)">Beginners (Начинающие)</option>
					<option value="Pro (Опытные)">Pro (Опытные)</option>
				</select>
			</div>

		</p>
		<p><strong>Возраст:</strong><br>
			<div style="color:#000">
				<select id="group_age" required name="group_age">
					<option selected disabled>Выберите возраст</option>
					<option value="4-6 Little stars">4-6 Little stars</option>
					<option value="7-9 kids">7-9 kids</option>
					<option value="10-12 juniors1">10-12 juniors1</option>
					<option value="13 – 15 juniors2">13 – 15 juniors2</option>
					<option value="Adults 16-19">Adults 16-19</option>
					<option value="Adults+ 20 лет и старше">Adults+ 20 лет и старше</option>
				</select>
			</div>
		</p>

		<h2 class="coloredHeader">Информация о выступлении</h2>

		<p><strong>Название номера: </strong><br>
			<input id="number_name" style="color:#000;margin-top:0.5vw;" required name="number_name" type="text"
				placeholder="Название номера"></p>
		<p><strong>Название команды: </strong><br>
			<input id="team_name" style="color:#000;margin-top:0.5vw;" required name="team_name" type="text"
				placeholder="Название команды / ФИО учасника(-ов)(Solo,Duo/Trio)"></p>
		<p><strong>Длительность выступления: </strong><br>
			<input id="duration" style="color:#000;margin-top:0.5vw;" required name="duration" type="time"
				placeholder="Длительность выступления"></p>
		<p><strong>Количество участников: </strong><br>
			<input id="amount" style="color:#000;margin-top:0.5vw;" required name="amount" type="number"
				placeholder="Количество участников"></p>
		<p><strong>Возраст самого младшего: </strong><br>
			<input id="min_age" style="color:#000;margin-top:0.5vw;" required name="min_age" type="number"
				placeholder="Возраст самого младшего"></p>
		<p><strong>Возраст самого старшего: </strong><br>
			<input id="max_age" style="color:#000;margin-top:0.5vw;" required name="max_age" type="number"
				placeholder="Возраст самого старшего"></p>
		<!-- <p><strong>Начало выступления: </strong><br><input name="begining_time" disabled type="time" placeholder="Начало выступления"></p> -->
		<p><strong>Стиль танцев: </strong><br><input id="dance_style" style="color:#000;margin-top:0.5vw;" required
				type="textarea" name="dance_style"
				placeholder="Укажите ваш стиль танца в данном направлении (например хип-хоп, контемпорари, эстрадный танец и т. д.)">
		</p>

		<p><strong>Аудио файл: ( mp3 или wav, до 24Мб ) </strong><br>
			<input id="file_name" required type="file" name="file_name" placeholder="Загрузите аудио файл" accept="audio/*" 
				style="margin-left: 42vw;margin-top:0.5vw;"></p>
		<span style="font-weight: : bold; text-decoration:underline; " id="old_file"></span>
		<h2 class="coloredHeader">Контактная информация</h2>
		<p><strong>ФИО: </strong><br>
			<input id="fio" style="color:#000;margin-top:0.5vw;" name="fio" required type="text"
				placeholder="ФИО руководителя"></p>

		<p><strong>Телефон: </strong><br>
			<input id="number" style="color:#000;margin-top:0.5vw;" name="tel_number" required type="tel"
				placeholder="Телефонный номер"></p>
		<p><strong>Почта: </strong><br>
			<input id="email" style="color:#000;margin-top:0.5vw;" required name="email" type="email"
				placeholder="Адрес электронной почты"></p>
		<p><strong>Facebook: </strong><br>
			<input id="facebook" style="color:#000;margin-top:0.5vw;" required name="facebook" type="url"
				placeholder="Ссылка на профиль Facebook"></p>
		<p><strong>Город: </strong><br>
			<input id="city" style="color:#000;margin-top:0.5vw;" required name="city" type="text" placeholder="Город">
		</p>

		<p><strong style="color: #e6af0e;">Фото чека с оплатой:( png | jpg | jpeg, до 5Мб ) </strong><br>
			<input id="photo_name" accept="image/*" type="file" name="photo_name" placeholder=""
				style="margin-left: 42vw;margin-top:0.5vw;"></p>
		<input class="submitButton" type="submit" onclick="send_data_form();">
	</form>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<script>
		window.onload = function(){
			document.getElementsByTagName('input')[10].onchange = function() {
			if (this.files[0]) // если выбрали файл
				document.getElementById("music_name_info_").value = this.files[0].name;
			};
		}
		function send_data_form() {
			
		

			var script_url = "https://script.google.com/macros/s/AKfycbzJi6ps1ah7OUIEtqcGHT39KkfZPlZZoi1EEo4k6JMkKkl_Iy8/exec";


  			var duration = $("#duration").val(),
				team_name = $("#team_name").val(),
				fio = $("#fio").val(),
				dance_style = $("#dance_style").val(),
				city = $("#city").val(),
				music = $("#music_name_info_").val(),
				get_id_form = document.getElementById("get_max_id_incr").value,
				url = window.location;

			if (url != "http://www.bestdancefest.com.ua/form/") {


				var url = script_url+"?callback=ctrlq&id_form="+id_form+"&duration="+duration+"&team_name="+team_name+"&fio="+fio+"&dance_style="+dance_style+"&city="+city+"&music="+music+"&action=update";

			}
			else{
				var url = script_url+"?callback=ctrlq&id_form="+get_id_form+"&duration="+duration+"&team_name="+team_name+"&fio="+fio+"&dance_style="+dance_style+"&city="+city+"&music="+music+"&action=insert";
			}
				

				alert(url);


			var request = jQuery.ajax({
			      crossDomain: true,
			      url: url ,
			      method: "GET",
			      dataType: "jsonp"
			    });

			
			
			var fd = new FormData(document.getElementById("form"));
			fd.append('file_name', $('#file_name')[0].files[0]);
			fd.append('photo_name', $('#photo_name')[0].files[0]);

			$.ajax({
				url: "/my.php",
				type: "POST",
				data: fd,
				success: function (data) {
					alert(data);
					window.location = "/";
				},
				processData: false,  // tell jQuery not to process the data
				contentType: false   // tell jQuery not to set contentType
			});
		}
		function format_data(data) {
		
			let splitted_data = data.split('::'),
				music_name_info = document.getElementById("music_name_info_");
			
			let input_id = [document.getElementById('nomination_selectA'),
			document.getElementById('category'),
			document.getElementById('skill_level'),
			document.getElementById('group_age'),
			document.getElementById('fio'),
			document.getElementById('number'),
			document.getElementById('email'),
			document.getElementById('facebook'),
			document.getElementById('city'),
			document.getElementById('number_name'),
			document.getElementById('team_name'),
			document.getElementById('duration'),
			document.getElementById('amount'),
			document.getElementById('min_age'),
			document.getElementById('max_age'),
			document.getElementById('photo_name'),
			document.getElementById('dance_style'),
			document.getElementById('old_file')];


			for (var i = 0; i < splitted_data.length; i++) {
				if (i == 0) {
					input_id[i].value = splitted_data[i].substring(1);
				}
				else if (i == 11) {
					input_id[i].value = splitted_data[i].substring(3);
				}	
				else if (i == 15) {
					input_id[i].name = splitted_data[i];
				}
				else if( i == 17 ){
					input_id[i].innerHTML +="Старая композиция: " + splitted_data[i];
				}
				else {
					input_id[i].value = splitted_data[i];
				}

			}

		}
		


		let url = window.location,
			reg = new RegExp("num_form=[0-9]+"),
			res_reg = reg.exec(url);
			
		//alert(window.location)
		if (url != "http://www.bestdancefest.com.ua/form/") {
			id_form = res_reg[0].substring(9);
			//alert("here")
			$.ajax({
				type: "POST",
				url: "/my_update.php",
				data: { 'id': id_form },
				success: function (phpData) {
					//alert(phpData);
					format_data(phpData);
				},
				complete: function () {
				},
				dataType: "text"
			});


			

		}




	</script>

	<script>
		$(document).ready(function () {
			checkFieldState();
			$("#category").change(checkFieldState);
		});

		function checkFieldState() {
			var selectedValue = document.getElementById("category").value;
			var result = document.getElementById("skill_level").value;
			if (selectedValue == "Solo" || selectedValue == "Duo/Trio") {

				document.getElementById("skill_level").innerHTML = '<option selected disabled>Выберите уровень</option>';
				document.getElementById("skill_level").innerHTML += '<option value="Pro (Опытные)">Pro (Опытные)</option>"';
			}
			else {
				document.getElementById("skill_level").innerHTML = '<option selected disabled>Выберите уровень</option>';
				document.getElementById("skill_level").innerHTML += '<option value="Beginners (Начинающие)">Beginners (Начинающие)</option>';
				document.getElementById("skill_level").innerHTML += '<option value="Pro (Опытные)">Pro (Опытные)</option>"';
			}
			document.getElementById("skill_level").value = result;
		}

	</script>
</div>

<style>
	input,
	button,
	select,
	textarea {
		width: 400px;
		text-align: center;
		padding: 10px;
	}

	.submitButton {
		background-color: #30c323;
		color: #fff;
		font-weight: 600;
		font-family: Roboto, Helvetica, sans-serif;
		border: 0;
		padding: 20px;
	}

	.submitButton:hover {
		background-color: #5ce750;
	}

	.coloredHeader {

		display: flex;
		margin: 30px auto;
		width: 600px;
		border: 1px solid;
		border-radius: 42px;
		padding: 20px;
		padding-top: 20px;
		padding-right: 20px;
		padding-bottom: 20px;
		padding-left: 20px;
		text-align: center;
		align-items: center;
		justify-content: center;
		cursor: default;
	}
</style>